<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Ivan Hanigan - Worflow flowcharts</title>
    <meta name="author" content="Ivan Hanigan" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/screen.css">
    <link href="http://feeds.feedburner.com/Disentanglethings" rel="alternate" title="RSS" type="application/rss+xml" />
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/jquery.github_v2.js"></script>
  </head>

  <body>


    <div id="header" class="section">
      <div class="wrapper">
        <strong id="blog-title">
          <a href="/" rel="home">Disentangle Things by Ivan Hanigan</a>
        </strong>
        <p id="blog-description"></p>
        <div id="navigation">
          <ul class="nav clearfix">
            <li class="first-child"><a href="/research.html">About My Notebook</a></li>
            <li> <a href="/blog.html">Entries</a></li> 
            <!-- <li><a href="/projects.html">Software</a></li>-->
            <li><a href="/about.html">About Me</a></li>
            <li><a href="/publications.html">My Publications</a></li>
            <li><a href="/cv.html">My CV</a></li>
            <li><a href="http://lmgtfy.com/?q=site%3Aivanhanigan.github.io">Search this Site</a></li> 
            <!--<li><a href="/donors.html">Donors</a></li>-->
          </ul>
        </div>
      </div>
    </div>
    <div id="main" class="section">
      <div class="wrapper">
        <div id="content">
          <h2>Welcome to my Open Notebook</h2>

<p>This is an Open Notebook with <a href="http://onsclaims.wikispaces.com/">Selected Content - Delayed</a>. Find out more <a href="/research.html">Here</a>.</p>

<p>  <img src="/images/ONS-SCD.png" alt="ONS-SCD.png" /></p>

          <div class="full">
  <h1 class="entry-title">
    <a href="/2013/07/worflow-flowcharts/" title="Worflow flowcharts" rel="bookmark">Worflow flowcharts</a>
  </h1>
  <!-- AddThis Button BEGIN -->
  <div class="addthis_toolbox addthis_default_style ">
    <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    <a class="addthis_button_tweet"></a>
    <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <!-- AddThis Button END -->
  <div class="entry-content full-content">
    <h2>What is the issue</h2>

<p>Most people seem to collect multiple datasets together in a single spot that can be split into 2 or more separate data packages.  I think this is a natural set up from an analysts perspective, where the results of multiple steps accumulate as 'stepping stones' toward the file they end up analysing.</p>

<p>I was first taught GIS by Isabelle Balzer at Ecowise Environmental Services in Canberra.  She showed me the method of keeping a table (sticky-taped to the desk!) of all the files and transformations that were going on. This was a method that didn't allow any multitasking!  I call this the 'Balzerian Method' (I am sure others used it before Isabelle, but I think Balzerian is a great word).</p>

<p>I think the data wharehouse at my work is an example, and probably we'll find the key challenge for big data will be for analysts to disentangle their own filing systems.</p>

<p>In my experience the way people store research data is often one (or a couple, or all) of these three types:</p>

<ul>
<li>a database with heaps of tables and views</li>
<li>a directory (and sub-directories) with heaps of files</li>
<li>a spreadsheet workbook with heaps of sheets (and links to other workbooks)</li>
</ul>


<p>I am developing a tool based on the open source graphviz softawre. The tool I am developing addresses the challenge of graphing the links between these sequential steps.</p>

<h4>Code:introducing newnode</h4>

<pre><code># NB this only works easily on linux
require(devtools)
install_github("disentangle", "ivanhanigan")
require(disentangle)
# the core of the tool is Rgraphviz, I just built a wrapper function
# to add newnodes to a graph of nodes
# always start with (newgraph = T) because the newnode function ADDS
# nodes to a graph, unless told otherwise, and fails if no 'nodes'
# object exists
nodes  &lt;- newnode(name="NAME",inputs="INPUT",outputs="OUTPUT", newgraph = T)
</code></pre>

<p><img src="/images/newnode1.png" alt="images/newnode1.png" /></p>

<h4>Code:adding nodes</h4>

<pre><code># now we can add nodes, and we can pass multiple inputs or outputs
nodes  &lt;- newnode(name="OUTPUT",inputs=c("NAME","ANOTHER THING"))
# outputs are optional
</code></pre>

<p><img src="/images/newnode2.png" alt="images/newnode2.png" /></p>

<p>It can be used in two or three ways.</p>

<h2>Example one, the composite view:</h2>

<p>So if there is a Balzerian filelist table available, convert it to a spreadsheet.  This is als similar to a labbook from Chemistry but follows a very rigid structure: NAME,        INPUTS,           OUTPUTS,         DESCRIPTION.  The first method I'll show will take one of these tables and map out the steps in the workflow.</p>

<h4>Code: Composite Worflow Files List</h4>

<pre><code>#    so if there is a Balzerian filelist table available,
# either make a spreadsheet with names, inputs and outputs 
# fileslist &lt;- read.csv("exampleFilesList.csv", stringsAsFactors = F)
# or 
filesList &lt;- read.csv(textConnection(
'NAME,        INPUTS,           OUTPUTS,         DESCRIPTION
FileA,        TableXYZ,         Input1,          Transformed variable
FileB,        TableABC,         Input2,          Collapsed dimensions
analysisFile, "Input1,Input2",  analysisResults, Merged inputs and analysed
'), stringsAsFactors = F, strip.white = T)
filesList

for(i in 1:nrow(filesList))
{
  nodes &lt;- newnode(name = filesList[i,"NAME"],
                   inputs = strsplit(filesList$INPUTS, ",")[[i]],
                   outputs = strsplit(filesList$OUTPUTS, ",")[[i]],
                   newgraph = (i == 1)
  )
}
</code></pre>

<h2>shows this result</h2>

<p><img src="/images/fileRelationships.png" alt="fileRelationships.png" /></p>

<h2>Example two, tracking the steps while analysing data:</h2>

<p>Structure a script into sections and document each section before evaluating the code to execute the step.  This works well with orgmode/ESS, Sweave or knitr style workflows.
For example:</p>

<h4>Code: Ad Hoc Files Lists Flowcharts</h4>

<pre><code>#### step one ####
nodes &lt;- newnode(name="FileA", inputs="TableXYZ", outputs="Input1",
                 newgraph =T) # this is required to tell newnode to
                              # start a new graph, rather than add to
                              # the nodes
FileA  &lt;- read.table("TableXYZ.txt")
Input1 &lt;- log(FileA$columnZ)

#### step two ####
nodes &lt;- newnode(name="FileB", inputs="TableABC", outputs="Input2")
FileB  &lt;- read.table("TableABC.txt")
Input2 &lt;- ddply(FileB, "id", summarise,
                duration = max(year) - min(year),
                nteams = length(unique(team)))

#### step three ####
nodes &lt;- newnode(name="analysisFile", inputs=c("Input1","Input2"),
                 outputs="analysisResults")
analysisFile  &lt;- merge(Input1, Input2, by="id")
analysisResults  &lt;- lm(y ~ duration + nteams, data = analysisFile)
</code></pre>

<h2>Example three: visualising relationships</h2>

<p>It is not aimed at visualising the linked structure of a tree or semi-lattice but can be used in such a way but changing the nodename and inputs concept to parent/child relationships.</p>

<p>As an example I'll describe how a list of database tables might be displayed as a tree. I am a great fan of Josh Reich due to his <a href="http://stackoverflow.com/a/1434424">LCFD workflow</a>, and I also like his work on the <a href="https://www.simple.com/">Simple Bank</a> so when I stumbled on this <a href="http://blog.i2pi.com/post/52812976752/joshs-postgresql-database-conventions">blog post</a> in which he says:</p>

<p>"Show me your flowchart and conceal your tables, and I shall continue to be mystified. Show me your tables, and I won’t usually need your flowchart; it’ll be obvious."</p>

<p>I was switched on and I started thinking about how the graphVis tool could be used to describe a list of tables and views from a database.</p>

<p>Say that two groups studied the same file TableXYZ with different inputs.  One of these groups wrote a seminal paper in the field, while their rivals wrote an inferior paper with a different result.  Imagine now a subsequent group who gathered the data from the previous work into the following database tables and conducted a replication study, with a new sensitivity analysis to explain why the original two papers produced different results.</p>

<p>Let's assume this database has all the data from all the groups in it and we want to get a pictorial view so we can disentangle which files belong to which study.  First get the following list of tables as INPUTS, grouping them by 'NAME' will give the tree structure and showing their results as OUTPUTS allows the subsequent replication study to use them as inputs and assume the position at the bottom of the flowchart.</p>

<h4>Code: database tables and different studies</h4>

<pre><code>filesList &lt;- read.csv(textConnection(
'NAME                 ,             INPUTS         , OUTPUTS
The Seminal Study     ,              FileA         , 
The Seminal Study     ,              FileB         , 
The Seminal Study     ,       analysisFile         , 
The Seminal Study     ,           TableXYZ         , 
The Seminal Study     ,           TableABC         , 
The Seminal Study     ,      Input1,Input2         ,
The Seminal Study     ,             Input1         , 
The Seminal Study     ,             Input2         , 
The Seminal Study     ,      The Seminal Study     , analysisResults 
The Inferior Rivals   ,                FileC       , 
The Inferior Rivals   ,        analysisFileX       , 
The Inferior Rivals   ,             TableXYZ       , 
The Inferior Rivals   ,               InputX       , 
The Inferior Rivals   ,    The Inferior Rivals     , analysisResultsX       
The Replication Study ,    "Input1,Input2,TableXYZ",  analysisResultsR     
The Replication Study ,    "Input1,InputX,TableXYZ",  sensitivityResult 
'), stringsAsFactors = F, strip.white = T)

for(i in 1:nrow(filesList))
{
  nodes &lt;- newnode(name = filesList[i,"NAME"],
                   inputs = strsplit(filesList$INPUTS, ",")[[i]],
                   outputs = strsplit(filesList$OUTPUTS, ",")[[i]],
                   newgraph = (i == 1)
  )
}
</code></pre>

<h2>the result</h2>

<p><img src="/images/filesRelationships2.png" alt="filesRelationships2.png" /></p>

    <div class="clear"></div>
  </div>
  <!-- AddThis Button BEGIN -->
  <div class="addthis_toolbox addthis_default_style ">
    <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    <a class="addthis_button_tweet"></a>
    <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <!-- AddThis Button END -->
  <p class="alt-font tight">
    Posted in&nbsp;
    
    <a href="/categories/research methods" title="research methods" rel="category tag">research methods</a>
    
  </p>
  <p class="by-line">
    <span class="date full-date">
      <abbr class="published" title="Wed Jul 31 00:00:00 +1000 2013">31 Jul 2013</abbr>
    </span>
  </p>
  <div class="clear"></div>
</div>
<div class="rule">
  <hr/>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'disentanglethings'; // required: replace example with your forum shortname

    var disqus_url = "http://ivanhanigan.github.com/2013/07/worflow-flowcharts/";

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

        </div>
        <div id="sidebar">
          <div id="carrington-subscribe" class="widget">
            <h2 class="widget-title">Subscribe</h2>
            <a class="feed alignright" title="RSS 2.0 feed for posts" rel="alternate" href="http://feeds.feedburner.com/Disentanglethings">
              <img src="/images/rss-button.gif" alt="latest posts" title="latest posts">
            </a>
          </div>
          <div id="carrington-about" class="widget">
            <div class="about">
              <h2 class="widget-title">About</h2>
<<<<<<< HEAD
              <p>I am a PhD Student at the Australian National University.</p>
=======
              <p>I am a data manager and data analyst at the Australian National University.</p>
>>>>>>> 08a5bb32cb6119bbf5f18a75e1a6d9f46307d601
              <a class="more" href="/about.html">more →</a>

            </div>
          </div>
          <!--
          	<p>
              <a href="http://ropensci.org/">
                <img src="/images/ropensci.png">
              </a>
        	</p>
			-->
			<!--
          <div id="carrington-link" class="widget">
          	<a href="http://ropensci.org/">
            <img src="/images/ropensci.png">
          </div>
          	-->
          
          <div id="primary-sidebar">
            <div class="widget">
              <h2 class="widget-title">Categories</h2>
              <ul>
<!-- <li> -->
<!--               <a class="workflow" href="/categories/workflow.html">workflow</a> -->
<!-- </li> -->
                
<<<<<<< HEAD
                <li><a href="/categories/spatial">spatial (6)</a></li>
                
                <li><a href="/categories/disentangle things">disentangle things (4)</a></li>
                
                <li><a href="/categories/spatial dependence">spatial dependence (9)</a></li>
                
                <li><a href="/categories/extreme weather events">extreme weather events (9)</a></li>
                
                <li><a href="/categories/e-collaboration">e-collaboration (1)</a></li>
                
                <li><a href="/categories/data documentation">data documentation (25)</a></li>
                
                <li><a href="/categories/overview">overview (7)</a></li>
                
                <li><a href="/categories/ecosocial tipping points">ecosocial tipping points (2)</a></li>
                
                <li><a href="/categories/cloud building">cloud building (2)</a></li>
                
                <li><a href="/categories/research methods">research methods (42)</a></li>
=======
                <li><a href="/categories/cloud building">cloud building (2)</a></li>
                
                <li><a href="/categories/e-collaboration">e-collaboration (1)</a></li>
                
                <li><a href="/categories/research methods">research methods (42)</a></li>
                
                <li><a href="/categories/Data Documentation">Data Documentation (24)</a></li>
                
                <li><a href="/categories/spatial">spatial (6)</a></li>
                
                <li><a href="/categories/disentangle things">disentangle things (4)</a></li>
                
                <li><a href="/categories/ecosocial tipping points">ecosocial tipping points (2)</a></li>
                
                <li><a href="/categories/spatial dependence">spatial dependence (9)</a></li>
                
                <li><a href="/categories/extreme weather events">extreme weather events (9)</a></li>
                
                <li><a href="/categories/overview">overview (7)</a></li>
>>>>>>> 08a5bb32cb6119bbf5f18a75e1a6d9f46307d601
                
              </ul>
              <h2 class="widget-title">Recent Entries</h2>
              <ul>
                
                <li>
<<<<<<< HEAD
                  <a href="/2014/05/cwt-lter-data-submission-template-critique/" title="cwt-lter-data-submission-template-critique" rel="bookmark">cwt-lter-data-submission-template-critique</a>
                </li>
                
                <li>
                  <a href="/2014/05/morpho-has-an-issue-with-zero-length-strings-as-missing-data/" title="morpho-has-an-issue-with-zero-length-strings-as-missing-data" rel="bookmark">morpho-has-an-issue-with-zero-length-strings-as-missing-data</a>
                </li>
                
                <li>
                  <a href="/2014/04/workaround-for-installing-morpho-on-a-windows-network/" title="workaround-for-installing-morpho-on-a-windows-network" rel="bookmark">workaround-for-installing-morpho-on-a-windows-network</a>
                </li>
                
                <li>
                  <a href="/2014/04/using-r-eml-to-input-large-numbers-of-variables-part-2/" title="using-r-eml-to-input-large-numbers-of-variables-part-2" rel="bookmark">using-r-eml-to-input-large-numbers-of-variables-part-2</a>
                </li>
                
                <li>
                  <a href="/2014/04/tweaking-r-eml-package-outputs-with-morpho-and-failing-that-with-emacs/" title="Tweaking R Eml Package Outputs With Morpho And Failing That With Emacs" rel="bookmark">Tweaking R Eml Package Outputs With Morpho And Failing That With Emacs</a>
=======
                  <a href="/2014/05/morpho-has-an-issue-with-zero-length-strings-as-missing-data/" title="morpho-has-an-issue-with-zero-length-strings-as-missing-data" rel="bookmark">morpho-has-an-issue-with-zero-length-strings-as-missing-data</a>
                </li>
                
                <li>
                  <a href="/2014/04/workaround-for-installing-morpho-on-a-windows-network/" title="workaround-for-installing-morpho-on-a-windows-network" rel="bookmark">workaround-for-installing-morpho-on-a-windows-network</a>
                </li>
                
                <li>
                  <a href="/2014/04/using-r-eml-to-input-large-numbers-of-variables-part-2/" title="using-r-eml-to-input-large-numbers-of-variables-part-2" rel="bookmark">using-r-eml-to-input-large-numbers-of-variables-part-2</a>
                </li>
                
                <li>
                  <a href="/2014/04/tweaking-r-eml-package-outputs-with-morpho-and-failing-that-with-emacs/" title="Tweaking R Eml Package Outputs With Morpho And Failing That With Emacs" rel="bookmark">Tweaking R Eml Package Outputs With Morpho And Failing That With Emacs</a>
                </li>
                
                <li>
                  <a href="/2014/04/using-reml-to-input-large-number-of-column-descriptions/" title="Using Reml To Input Large Number Of Column Descriptions" rel="bookmark">Using Reml To Input Large Number Of Column Descriptions</a>
>>>>>>> 08a5bb32cb6119bbf5f18a75e1a6d9f46307d601
                </li>
                
              </ul>
              <h2 class="widget-title">Entries grouped by Tags</h2>
              <ul>
                
                <li><a href="/tag/R-eml">R-eml (3)</a></li>
                
<<<<<<< HEAD
                <li><a href="/tag/morpho">morpho (7)</a></li>
=======
                <li><a href="/tag/morpho">morpho (5)</a></li>
>>>>>>> 08a5bb32cb6119bbf5f18a75e1a6d9f46307d601
                
                <li><a href="/tag/bugs">bugs (1)</a></li>
                
              <div class="clear"></div>
              </ul>
            </div>
          </div>
          <!-- <div id="secondary-sidebar"> -->
          <!--   <div class="widget"> -->
          <!--     <h2 class="widget-title">Tags</h2> -->
          <!--     <ul> -->
          <!--        -->
          <!--       <li><a href="/tag/R-eml">R-eml (3)</a></li> -->
          <!--        -->
<<<<<<< HEAD
          <!--       <li><a href="/tag/morpho">morpho (7)</a></li> -->
=======
          <!--       <li><a href="/tag/morpho">morpho (5)</a></li> -->
>>>>>>> 08a5bb32cb6119bbf5f18a75e1a6d9f46307d601
          <!--        -->
          <!--       <li><a href="/tag/bugs">bugs (1)</a></li> -->
          <!--        -->
          <!--     <div class="clear"></div> -->
          <!--     </ul> -->
          <!--   </div> -->
            <!--
            <div class="widget">
              <h2 class="widget-title">Archives</h2>
              <ul>
                
              </ul>
              <div class="clear"></div>
            </div>
            -->
          </div>
        </div>
      </div>
    </div>
    <div id="footer" class="section">
      <div class="wrapper">
        <a id="generator-link">
          Banner Artwork by Cindy Hales. Site powered by
          <a href="https://github.com/mojombo/jekyll" rel="generator">Jekyll</a>
          with
          <a href="http://carringtontheme.com" title="Carrington theme for WordPress">Carrington</a>
          theme.
      </div>
      <div id="developer-link">
      </div>
    </div>
    <!--
	<a href="http://github.com/SChamberlain"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://assets2.github.com/img/e6bef7a091f5f3138b8cd40bc3e114258dd68ddf?repo=&url=http%3A%2F%2Fs3.amazonaws.com%2Fgithub%2Fribbons%2Fforkme_right_red_aa0000.png&path=" alt="Fork me on GitHub"></a>
	-->
    <script type="text/javascript">
      var disqus_shortname = 'disentanglethings';

      (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
    </script>
    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-28059658-1");
        pageTracker._trackPageview();
      } catch(err) {}
    </script>
  </body>
</html>
