--- 
name: ecological-networks-from-abundance
layout: post
title: Ecological networks from abundance distributions
date: 2011-01-06 08:58:00.001000 -06:00
categories: 
- Ecology
- Networks
- R
---

Another grad student and I tried recently to make a contribution to our understanding of the relationship between ecological network structure (e.g., nestedness) and community structure (e.g., evenness)...

...Alas, I had no luck making new insights. However, I am providing the code used for this failed attempt in hopes that someone may find it useful. This is very basic code. It was roughly based off of the paper by Bluthgen et al. 2008 Ecology (<a href="http://www.esajournals.org/doi/abs/10.1890/07-2121.1?journalCode=ecol">here</a>). In my code the number of interactions is set to 600, and there are 30 plant species, and 10 animal species. This assumes they share the same abundance distributions and sigma values. <br /><br />UPDATE: I changed the below code a bit to just output the metrics links per species, interaction evenness and H2.<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;">#######################################################</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">(</span><a href="http://www.blogger.com/packages/bipartite">bipartite</a><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># Set of mean and sd combinations of log-normal distribution</span><br /><span style="color: #666666; font-style: italic;"># In my case, these values were those empirically estimated </span><br /><span style="color: #666666; font-style: italic;"># from many bipartite networks from the Interaction Web Database</span><br />mu &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2.9</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">5.3</span><span style="color: #009900;">)</span><br />sig &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0.75</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1.6</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2.45</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># Function to make a set of matrices based on some combination of mu and sigma values</span><br />make.matrices &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>a<span style="color: #339933;">,</span>b<span style="color: #339933;">,</span>nmats<span style="color: #009900;">)</span><span style="color: #009900;">{</span><br /> plants &lt;- <a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/rlnorm"><span style="color: #003399; font-weight: bold;">rlnorm</span></a><span style="color: #009900;">(</span>n=<span style="color: #cc66cc;">30</span><span style="color: #339933;">,</span> meanlog=mu<span style="color: #009900;">[</span>a<span style="color: #009900;">]</span><span style="color: #339933;">,</span> sdlog=sig<span style="color: #009900;">[</span>b<span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /> <a href="http://inside-r.org/r-doc/cluster/animals"><span style="color: #003399; font-weight: bold;">animals</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/rlnorm"><span style="color: #003399; font-weight: bold;">rlnorm</span></a><span style="color: #009900;">(</span>n=<span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span> meanlog=mu<span style="color: #009900;">[</span>a<span style="color: #009900;">]</span><span style="color: #339933;">,</span> sdlog=sig<span style="color: #009900;">[</span>b<span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /> plants &lt;- plants*<span style="color: #009900;">(</span><span style="color: #cc66cc;">600</span>/sum<span style="color: #009900;">(</span>plants<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /> <a href="http://inside-r.org/r-doc/cluster/animals"><span style="color: #003399; font-weight: bold;">animals</span></a> &lt;- <a href="http://inside-r.org/r-doc/cluster/animals"><span style="color: #003399; font-weight: bold;">animals</span></a>*<span style="color: #009900;">(</span><span style="color: #cc66cc;">600</span>/sum<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/cluster/animals"><span style="color: #003399; font-weight: bold;">animals</span></a><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /> <a href="http://inside-r.org/r-doc/stats/r2dtable"><span style="color: #003399; font-weight: bold;">r2dtable</span></a><span style="color: #009900;">(</span>nmats<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/cluster/animals"><span style="color: #003399; font-weight: bold;">animals</span></a><span style="color: #339933;">,</span>plants<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># Output matrices</span><br />matrices11 &lt;- make.matrices<span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">100</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># Etc. for the remaining combinations of mu and sigma</span><br /><span style="color: #666666; font-style: italic;">#matrices12 &lt;- make.matrices(1,2,100)</span><br /><span style="color: #666666; font-style: italic;">#matrices13 &lt;- make.matrices(1,3,100)</span><br /><span style="color: #666666; font-style: italic;">#matrices21 &lt;- make.matrices(2,1,100)</span><br /><span style="color: #666666; font-style: italic;"># etc.....</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># Calculate some network metrics-e.g., for one combination of mu and sigma</span><br />linkspersp11 &lt;- <a href="http://inside-r.org/r-doc/base/numeric"><span style="color: #003399; font-weight: bold;">numeric</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100</span><span style="color: #009900;">)</span><br />inteven11 &lt;- <a href="http://inside-r.org/r-doc/base/numeric"><span style="color: #003399; font-weight: bold;">numeric</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100</span><span style="color: #009900;">)</span><br />h211 &lt;- <a href="http://inside-r.org/r-doc/base/numeric"><span style="color: #003399; font-weight: bold;">numeric</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: black; font-weight: bold;">for</span><span style="color: #009900;">(</span>i <span style="color: black; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span>:<a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>matrices11<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">{</span><br />  m &lt;- <a href="http://inside-r.org/r-doc/base/matrix"><span style="color: #003399; font-weight: bold;">matrix</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/unlist"><span style="color: #003399; font-weight: bold;">unlist</span></a><span style="color: #009900;">(</span>matrices11<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/ncol"><span style="color: #003399; font-weight: bold;">ncol</span></a>=<span style="color: #cc66cc;">30</span><span style="color: #339933;">,</span>byrow=F<span style="color: #009900;">)</span><br />  metrics &lt;- <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">(</span>networklevel<span style="color: #009900;">(</span>m<span style="color: #339933;">,</span>index=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">"links per species"</span><span style="color: #339933;">,</span><span style="color: blue;">"H2"</span><span style="color: #339933;">,</span><span style="color: blue;">"interaction evenness"</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />  linkspersp11<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span> &lt;- metrics<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><br /> inteven11<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span> &lt;- metrics<span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><br /> h211<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span> &lt;- metrics<span style="color: #009900;">[</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">]</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />linkspersp11<br />h211<br />inteven11</pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a>
