--- 
name: basic-ggplot2-network-graphs
layout: post
title: basic ggplot2 network graphs
date: 2011-03-17 08:35:00 -05:00
categories: 
- ggplot2
- bipartite
- Networks
- igraph
- R
---
I have been looking around on the web and have not found anything yet related to using ggplot2 for making graphs/networks. I put together a few functions to make very simple graphs. The bipartite function especially is not ideal, as of course we only want to allow connections between unlike nodes, not all nodes. These functions do not, obviously, take full advantage of the power of ggplot2, but&nbsp;itâ€™s a start.<br /><br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"># ggplot network graphics functions</span><br /><span style="color: #666666; font-style: italic;"># g = an igraph graph object, any igraph graph object</span><br /><span style="color: #666666; font-style: italic;"># vplace = type of vertex placement assignment, one of rnorm, runif, etc.</span><br />&nbsp;<br />gggraph &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>g<span style="color: #339933;">,</span> vplace = <a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />&nbsp;<br /> <a href="http://inside-r.org/r-doc/base/require"><span style="color: #003399; font-weight: bold;">require</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span><br />&nbsp;<br /> g_ &lt;- get.edgelist<span style="color: #009900;">(</span>g<span style="color: #009900;">)</span><br /> g_df &lt;- <a href="http://inside-r.org/r-doc/base/as.data.frame"><span style="color: #003399; font-weight: bold;">as.data.frame</span></a><span style="color: #009900;">(</span>g_<span style="color: #009900;">)</span><br /> g_df$id &lt;- <span style="color: #cc66cc;">1</span>:<a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>g_df<span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><br /> g_df &lt;- melt<span style="color: #009900;">(</span>g_df<span style="color: #339933;">,</span> id=<span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span><br /> xy_s &lt;- <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">(</span>value = <a href="http://inside-r.org/r-doc/base/unique"><span style="color: #003399; font-weight: bold;">unique</span></a><span style="color: #009900;">(</span>g_df$value<span style="color: #009900;">)</span><span style="color: #339933;">,</span> <br />  x = vplace<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/unique"><span style="color: #003399; font-weight: bold;">unique</span></a><span style="color: #009900;">(</span>g_df$value<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <br />  y = vplace<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/unique"><span style="color: #003399; font-weight: bold;">unique</span></a><span style="color: #009900;">(</span>g_df$value<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /> g_df2 &lt;- <a href="http://inside-r.org/r-doc/base/merge"><span style="color: #003399; font-weight: bold;">merge</span></a><span style="color: #009900;">(</span>g_df<span style="color: #339933;">,</span> xy_s<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/by"><span style="color: #003399; font-weight: bold;">by</span></a> = <span style="color: blue;">"value"</span><span style="color: #009900;">)</span> <br />&nbsp;<br /> p &lt;- <a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span>g_df2<span style="color: #339933;">,</span> aes<span style="color: #009900;">(</span>x<span style="color: #339933;">,</span> y<span style="color: #009900;">)</span><span style="color: #009900;">)</span> +<br />  geom_point<span style="color: #009900;">(</span><span style="color: #009900;">)</span> +<br />  geom_line<span style="color: #009900;">(</span>size = <span style="color: #cc66cc;">0.3</span><span style="color: #339933;">,</span> aes<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/grDevices/group"><span style="color: #003399; font-weight: bold;">group</span></a> = id<span style="color: #339933;">,</span> linetype = id<span style="color: #009900;">)</span><span style="color: #009900;">)</span> +<br />  geom_text<span style="color: #009900;">(</span>size = <span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> hjust = <span style="color: #cc66cc;">1.5</span><span style="color: #339933;">,</span> aes<span style="color: #009900;">(</span>label = value<span style="color: #009900;">)</span><span style="color: #009900;">)</span> +<br />  theme_bw<span style="color: #009900;">(</span><span style="color: #009900;">)</span> + <br />  opts<span style="color: #009900;">(</span>panel.grid.major=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <br />   panel.grid.minor=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <br />   axis.text.x=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   axis.text.y=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   axis.title.x=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   axis.title.y=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   axis.ticks=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   panel.border=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   legend.position=<span style="color: blue;">"none"</span><span style="color: #009900;">)</span><br />&nbsp;<br /> p<br />&nbsp;<br /><span style="color: #009900;">}</span><br />&nbsp;<br />ggbigraph &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>g<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />&nbsp;<br /> <a href="http://inside-r.org/r-doc/base/require"><span style="color: #003399; font-weight: bold;">require</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span> <br />&nbsp;<br /> g_ &lt;- get.edgelist<span style="color: #009900;">(</span>g<span style="color: #009900;">)</span><br /> g_df &lt;- <a href="http://inside-r.org/r-doc/base/as.data.frame"><span style="color: #003399; font-weight: bold;">as.data.frame</span></a><span style="color: #009900;">(</span>g_<span style="color: #009900;">)</span><br /> g_df$id &lt;- <span style="color: #cc66cc;">1</span>:<a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>g_df<span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><br /> g_df &lt;- melt<span style="color: #009900;">(</span>g_df<span style="color: #339933;">,</span> id=<span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span><br /> xy_s &lt;- <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">(</span>value = <a href="http://inside-r.org/r-doc/base/unique"><span style="color: #003399; font-weight: bold;">unique</span></a><span style="color: #009900;">(</span>g_df$value<span style="color: #009900;">)</span><span style="color: #339933;">,</span> <br />  x = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/unique"><span style="color: #003399; font-weight: bold;">unique</span></a><span style="color: #009900;">(</span>g_df$value<span style="color: #009900;">)</span><span style="color: #009900;">)</span>/<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/unique"><span style="color: #003399; font-weight: bold;">unique</span></a><span style="color: #009900;">(</span>g_df$value<span style="color: #009900;">)</span><span style="color: #009900;">)</span>/<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />  y = <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/unique"><span style="color: #003399; font-weight: bold;">unique</span></a><span style="color: #009900;">(</span>g_df$value<span style="color: #009900;">)</span><span style="color: #009900;">)</span>/<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /> g_df2 &lt;- <a href="http://inside-r.org/r-doc/base/merge"><span style="color: #003399; font-weight: bold;">merge</span></a><span style="color: #009900;">(</span>g_df<span style="color: #339933;">,</span> xy_s<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/by"><span style="color: #003399; font-weight: bold;">by</span></a> = <span style="color: blue;">"value"</span><span style="color: #009900;">)</span> <br />&nbsp;<br /> p &lt;- <a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span>g_df2<span style="color: #339933;">,</span> aes<span style="color: #009900;">(</span>x<span style="color: #339933;">,</span> y<span style="color: #009900;">)</span><span style="color: #009900;">)</span> +<br />  geom_point<span style="color: #009900;">(</span><span style="color: #009900;">)</span> +<br />  geom_line<span style="color: #009900;">(</span>size = <span style="color: #cc66cc;">0.3</span><span style="color: #339933;">,</span> aes<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/grDevices/group"><span style="color: #003399; font-weight: bold;">group</span></a> = id<span style="color: #339933;">,</span> linetype = id<span style="color: #009900;">)</span><span style="color: #009900;">)</span> +<br />  geom_text<span style="color: #009900;">(</span>size = <span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> hjust = <span style="color: #cc66cc;">1.5</span><span style="color: #339933;">,</span> aes<span style="color: #009900;">(</span>label = value<span style="color: #009900;">)</span><span style="color: #009900;">)</span> +<br />  theme_bw<span style="color: #009900;">(</span><span style="color: #009900;">)</span> + <br />  opts<span style="color: #009900;">(</span>panel.grid.major=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <br />   panel.grid.minor=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <br />   axis.text.x=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   axis.text.y=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   axis.title.x=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   axis.title.y=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   axis.ticks=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   panel.border=theme_blank<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />   legend.position=<span style="color: blue;">"none"</span><span style="color: #009900;">)</span><br />&nbsp;<br /> p<br />&nbsp;<br /><span style="color: #009900;">}</span><br />&nbsp;<br /></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><br /></span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;">g </span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;">&lt;-</span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"> erdos.renyi.game</span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span style="color: #009900;">(</span></span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span style="color: #cc66cc;">20</span></span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span style="color: #339933;">,</span></span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"> </span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span style="color: #cc66cc;">5</span></span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span style="color: #339933;">,</span></span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"> type=</span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span style="color: blue;">"gnm"</span></span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span style="color: #009900;">)</span></span><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;">gggraph<span style="color: #009900;">(</span>g<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">)</span><br /><br /><span class="Apple-style-span" style="font-family: Times; white-space: normal;"><a href="https://lh4.googleusercontent.com/-temZDywVoc4/TYIKYwRq8VI/AAAAAAAAEa0/iGOIfRHOcag/s1600/erdos.jpeg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh4.googleusercontent.com/-temZDywVoc4/TYIKYwRq8VI/AAAAAAAAEa0/iGOIfRHOcag/s320/erdos.jpeg" style="cursor: move;" width="320" /></a></span>&nbsp;<br /></pre><pre class="r geshifilter-R" style="font-family: monospace;">g &lt;- barabasi.game<span style="color: #009900;">(</span><span style="color: #cc66cc;">20</span><span style="color: #009900;">)</span><br />gggraph<span style="color: #009900;">(</span>g<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">)</span><br /><br /><span class="Apple-style-span" style="font-family: Times; white-space: normal;"><a href="https://lh6.googleusercontent.com/-nSqXm1dW6Ao/TYIKYZ6yjDI/AAAAAAAAEaw/zobQWHPdo4k/s1600/barabasi.jpeg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="400" src="https://lh6.googleusercontent.com/-nSqXm1dW6Ao/TYIKYZ6yjDI/AAAAAAAAEaw/zobQWHPdo4k/s400/barabasi.jpeg" style="cursor: move;" width="400" /></a></span><br /></pre><pre class="r geshifilter-R" style="font-family: monospace;">g &lt;- grg.game<span style="color: #009900;">(</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.45</span><span style="color: #339933;">,</span> torus=<span style="color: black; font-weight: bold;">FALSE</span><span style="color: #009900;">)</span><br />gggraph<span style="color: #009900;">(</span>g<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">)</span><br /><br /><span class="Apple-style-span" style="font-family: Times; white-space: normal;"><a href="https://lh6.googleusercontent.com/-93Hfy7-95dM/TYIKZX1iYDI/AAAAAAAAEa4/J2qHu-RJmaw/s1600/grg.jpeg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="400" src="https://lh6.googleusercontent.com/-93Hfy7-95dM/TYIKZX1iYDI/AAAAAAAAEa4/J2qHu-RJmaw/s400/grg.jpeg" style="cursor: move;" width="400" /></a></span></pre><pre class="r geshifilter-R" style="font-family: monospace;">&nbsp;<br />g &lt;- growing.random.game<span style="color: #009900;">(</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/citation"><span style="color: #003399; font-weight: bold;">citation</span></a>=<span style="color: black; font-weight: bold;">FALSE</span><span style="color: #009900;">)</span><br />gggraph<span style="color: #009900;">(</span>g<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">)</span><br /><br /><span class="Apple-style-span" style="font-family: Times; white-space: normal;"><a href="https://lh5.googleusercontent.com/-CjzA2KZEIAE/TYIKZ6ObahI/AAAAAAAAEa8/6Z6yPvDueb4/s1600/growing.jpeg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="400" src="https://lh5.googleusercontent.com/-CjzA2KZEIAE/TYIKZ6ObahI/AAAAAAAAEa8/6Z6yPvDueb4/s400/growing.jpeg" style="cursor: move;" width="400" /></a></span>&nbsp;</pre><pre class="r geshifilter-R" style="font-family: monospace;">g &lt;- watts.strogatz.game<span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.05</span><span style="color: #009900;">)</span><br />gggraph<span style="color: #009900;">(</span>g<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">)</span><br /></pre></div></div><a href="https://lh4.googleusercontent.com/-cZ_WB68N2XU/TYIKacOgyuI/AAAAAAAAEbA/gfwfbwKd2vg/s1600/watts.jpeg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh4.googleusercontent.com/-cZ_WB68N2XU/TYIKacOgyuI/AAAAAAAAEbA/gfwfbwKd2vg/s320/watts.jpeg" style="cursor: move;" width="320" /></a><br /><br /><br /># A bipartite graphs<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;">g &lt;- grg.game<span style="color: #009900;">(</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.45</span><span style="color: #339933;">,</span> torus=<span style="color: black; font-weight: bold;">FALSE</span><span style="color: #009900;">)</span><br />ggbigraph<span style="color: #009900;">(</span>g<span style="color: #009900;">)</span><br /></pre></div></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://lh5.googleusercontent.com/-6x2w4PZvOwU/TYIM3qQ0PnI/AAAAAAAAEbE/LKMMuqylYXk/s1600/grg-bipartite.jpeg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="400" src="https://lh5.googleusercontent.com/-6x2w4PZvOwU/TYIM3qQ0PnI/AAAAAAAAEbE/LKMMuqylYXk/s400/grg-bipartite.jpeg" width="400" /></a></div>
