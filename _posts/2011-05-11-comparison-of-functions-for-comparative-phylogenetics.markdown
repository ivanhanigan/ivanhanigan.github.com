--- 
name: comparison-of-functions-for-comparative-phylogenetics
layout: post
title: Comparison of functions for comparative phylogenetics
date: 2011-05-11 10:08:00 -05:00
categories: 
- Evolution
- ape
- Phylogenetics
- R
- motmot
---
With all the packages (and beta stage groups of functions) for comparative phylogenetics in R (tested here: picante, geiger, ape, motmot, Liam Revell's functions), I was simply interested in which functions to use in cases where multiple functions exist to do the same thing. I only show default settings, so perhaps these functions would differ under different parameter settings. &nbsp;[I am using a Mac 2.4 GHz i5, 4GB RAM]<br /><br />Get motmot here:&nbsp;<a href="https://r-forge.r-project.org/R/?group_id=782">https://r-forge.r-project.org/R/?group_id=782</a><br />Get Liam Revell's functions here:&nbsp;<a href="http://anolis.oeb.harvard.edu/~liam/R-phylogenetics/">http://anolis.oeb.harvard.edu/~liam/R-phylogenetics/</a><br /><br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;">&gt; <span style="color: #666666; font-style: italic;"># Load </span><br /><a href="http://inside-r.org/r-doc/base/require"><span style="color: #003399; font-weight: bold;">require</span></a><span style="color: #009900;">(</span>motmot<span style="color: #009900;">)</span><span style="color: #339933;">;</span> <a href="http://inside-r.org/r-doc/base/require"><span style="color: #003399; font-weight: bold;">require</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/geiger">geiger</a><span style="color: #009900;">)</span><span style="color: #339933;">;</span> <a href="http://inside-r.org/r-doc/base/require"><span style="color: #003399; font-weight: bold;">require</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/picante">picante</a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/source"><span style="color: #003399; font-weight: bold;">source</span></a><span style="color: #009900;">(</span><span style="color: blue;">"http://anolis.oeb.harvard.edu/~liam/R-phylogenetics/phylosig/v0.3/phylosig.R"</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/source"><span style="color: #003399; font-weight: bold;">source</span></a><span style="color: #009900;">(</span><span style="color: blue;">"http://anolis.oeb.harvard.edu/~liam/R-phylogenetics/fastBM/v0.4/fastBM.R"</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># Make tree</span><br /><a href="http://inside-r.org/packages/cran/tree">tree</a> &lt;- rcoal<span style="color: #009900;">(</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span><br />&nbsp;<br /><br /></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"><br /></span></pre><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"><br /></span></pre><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"><br /></span></pre><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"># Transform branch lengths</span><br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span> transformPhylo<span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #339933;">,</span> model = <span style="color: blue;">"lambda"</span><span style="color: #339933;">,</span> lambda = <span style="color: #cc66cc;">0.5</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># motmot</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">1.757</span>   <span style="color: #cc66cc;">0.004</span>   <span style="color: #cc66cc;">1.762</span> <br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span> lambdaTree<span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.9</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># geiger</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">3.708</span>   <span style="color: #cc66cc;">0.008</span>   <span style="color: #cc66cc;">3.716</span> <br />&gt;   <span style="color: #666666; font-style: italic;"># motmot wins!!!</span><br /></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"><span class="Apple-style-span" style="color: #666666; font-style: italic;"><br /></span></pre><pre class="r geshifilter-R" style="font-family: monospace;"><span class="Apple-style-span" style="color: #666666; font-style: italic;"><br /></span></pre><pre class="r geshifilter-R" style="font-family: monospace;"><span class="Apple-style-span" style="color: #666666; font-style: italic;"># Simulate trait evolution</span></pre><pre class="r geshifilter-R" style="font-family: monospace;"><a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span> transformPhylo.sim<span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #339933;">,</span> model = <span style="color: blue;">"bm"</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># motmot</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">3.732</span>   <span style="color: #cc66cc;">0.007</span>   <span style="color: #cc66cc;">3.741</span> <br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span> rTraitCont<span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #339933;">,</span> model = <span style="color: blue;">"BM"</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># ape</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">0.312</span>   <span style="color: #cc66cc;">0.009</span>   <span style="color: #cc66cc;">0.321</span> <br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span> fastBM<span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># Revell</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">1.315</span>   <span style="color: #cc66cc;">0.005</span>   <span style="color: #cc66cc;">1.320</span> <br />&gt;   <span style="color: #666666; font-style: italic;"># ape wins!!!</span><br /><span style="color: #666666; font-style: italic;"><br /></span></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"># Phylogenetically independent contrasts<br />trait &lt;- <a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">(</span>trait<span style="color: #009900;">)</span> &lt;- <a href="http://inside-r.org/packages/cran/tree">tree</a>$tip.label<br />&nbsp;<br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">10000</span><span style="color: #339933;">,</span> pic.motmot<span style="color: #009900;">(</span>trait<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #009900;">)</span>$contr<span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span>  <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># motmot</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">3.062</span>   <span style="color: #cc66cc;">0.007</span>   <span style="color: #cc66cc;">3.070</span> <br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">10000</span><span style="color: #339933;">,</span> pic<span style="color: #009900;">(</span>trait<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># ape</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">2.846</span>   <span style="color: #cc66cc;">0.007</span>   <span style="color: #cc66cc;">2.853</span> <br />&gt;   <span style="color: #666666; font-style: italic;"># ape wins!!!</span><br /><span style="color: #666666; font-style: italic;"><br /></span></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"># Phylogenetic signal, Blomberg's K<br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100</span><span style="color: #339933;">,</span> Kcalc<span style="color: #009900;">(</span>trait<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #009900;">)</span><span style="color: #009900;">)</span>  <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># picante</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">1.311</span>   <span style="color: #cc66cc;">0.005</span>   <span style="color: #cc66cc;">1.316</span> <br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100</span><span style="color: #339933;">,</span> phylosig<span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #339933;">,</span> trait<span style="color: #339933;">,</span> method = <span style="color: blue;">"K"</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># Revell</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">0.201</span>   <span style="color: #cc66cc;">0.000</span>   <span style="color: #cc66cc;">0.202</span> <br />&gt;   <span style="color: #666666; font-style: italic;"># Liam Revell wins!!!</span><br /><span style="color: #666666; font-style: italic;"><br /></span></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"># Ancestral character state estimation<br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100</span><span style="color: #339933;">,</span> ace<span style="color: #009900;">(</span>trait<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #009900;">)</span>$ace<span style="color: #009900;">)</span> <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># ape</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">4.988</span>   <span style="color: #cc66cc;">0.018</span>   <span style="color: #cc66cc;">5.007</span> <br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100</span><span style="color: #339933;">,</span> getAncStates<span style="color: #009900;">(</span>trait<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/tree">tree</a><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># geiger</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">2.253</span>   <span style="color: #cc66cc;">0.005</span>   <span style="color: #cc66cc;">2.258</span> <br />&gt;   <span style="color: #666666; font-style: italic;"># geiger wins!!!</span></pre><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"><br /></span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br /><br />__________<br />It's hard to pick an overall winner because not all functions are available in all packages, but there are definitely some functions that are faster than others.
