<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Ivan Hanigan - Disentangle Things</title>
    <meta name="author" content="Ivan Hanigan" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/screen.css">
    <link href="http://feeds.feedburner.com/Disentanglethings" rel="alternate" title="RSS" type="application/rss+xml" />
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/jquery.github_v2.js"></script>
  </head>

  <body>


    <div id="header" class="section">
      <div class="wrapper">
        <strong id="blog-title">
          <a href="/" rel="home">Disentangle Things by Ivan Hanigan</a>
        </strong>
        <p id="blog-description"></p>
        <div id="navigation">
          <ul class="nav clearfix">
            <li> <a href="/blog/">Notes</a></li> 
            <li><a href="/research/">About Open Notebooks</a></li>
            <li><a href="/projects/">Projects</a></li>
            <li><a href="http://orcid.org/0000-0002-6360-6793">CV</a></li>
            <li><a href="http://lmgtfy.com/?q=site%3Aivanhanigan.github.io">Search this Site</a></li> 
          </ul>
        </div>
      </div>
    </div>
    <div id="main" class="section">
      <div class="wrapper">
        <div id="content">
          <h2>Welcome to my Open Notebook</h2>
            <!--<li class="first-child"><a href="/research.html">About My Notebook</a></li>-->
            <!--<li><a href="/donors.html">Donors</a></li>-->
            <!-- <li><a href="/projects.html">Data</a></li> -->
            <!--<li><a href="/publications.html">Journal Publications</a></li>-->
<p>This is an Open Notebook with <a href="https://en.wikipedia.org/wiki/Open_notebook_science" target="new">Selected Content - Delayed</a>. All content is licenced with CC-BY. Find out more <a href="/research">Here</a>.</p>

<p>  <img src="/images/ONS-SCD.png" alt="ONS-SCD.png" /></p>

          <!-- AddThis Button BEGIN -->
<!-- <div class="addthis_toolbox addthis_default_style "> -->
<!--   <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a> -->
<!--   <a class="addthis_button_tweet"></a> -->
<!--   <a class="addthis_button_google_plusone" g:plusone:size="medium"></a> -->
<!--   <a class="addthis_counter addthis_pill_style"></a> -->
<!-- </div> -->
<!-- <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=SChamberlain"></script> -->
<!-- AddThis Button END -->

  <div class="full">
    <h1 class="entry-title">
      <a href="/2013/10/data-documentation-case-study-reml-and-rfigshare/" title="data-documentation-case-study-reml-and-rfigshare" rel="bookmark">data-documentation-case-study-reml-and-rfigshare</a>
    </h1>
    <div class="entry-content full-content">
      <h4 id="case-study-reml-and-rfigshare">Case Study: reml-and-rfigshare</h4>
<p>First we will look at the work of the ROpenSci team and the reml
package.  In the vignette they show how to publish data to figshare
using rfigshare package.  <a href="http://figshare.com/">figshare</a> is a site
where scientists can share datasets/figures/code. The goals are to
encourage researchers to share negative results and make reproducible
research efforts user-friendly. It also uses a tagging system for
scientific research discovery. They give you unlimited public space
and 1GB of private space.</p>

<p>Start by getting the reml package.</p>

<h4 id="code">Code:</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># func
require(devtools)
install_github("reml", "ropensci")
require(reml)
?eml_write
</code></pre></div></div>
<p></p>
<p>This is the Top-level API function for writing eml.  Help page is a bit sparse.  See <a href="https://github.com/ropensci/reml">This Link</a> for more.  For eg “for convenience, dat could simply be a data.frame and reml will launch it’s metadata wizard to assist in constructing the metadata based on the data.frame provided. While this may be helpful starting out, regular users will find it faster to define the columns and units directly in the format above.”</p>

<p>Now load up the test data for classification trees I described in <a href="/2013/10/test-data-for-classification-trees/">This Post</a></p>

<h4 id="code-1">Code:</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>install_github("disentangle", "ivanhanigan") # for the data
                                             # described in prev post

# load
fpath &lt;- system.file(file.path("extdata", "civst_gend_sector.csv"),
                     package = "disentangle"
                     )
civst_gend_sector &lt;- read.csv(fpath)

# clean
str(civst_gend_sector)

# do
eml_write(civst_gend_sector,
          creator = "Ivan Hanigan &lt;ivanhanigan@gmail.com&gt;")


          


# Starts up the wizard, a section is shown below.  The wizard
# prompts in the console and the user writes the answer.

# Enter description for column 'civil_status':
#  marriage status
# column civil_status appears to contain categorical data.
#  
# Categories are divorced/widowed, married, single
#  Please define each of the categories at the prompt
# define 'divorced/widowed':
# was once married
# define 'married':
# still married
# define 'single':
# never married

# TODO I don't really know what activity_sector is.  I assumed
# school because Categories are primary, secondary, tertiary.

# this created "metadata.xml" and "metadata.csv"
file.remove(c("metadata.xml","metadata.csv"))
</code></pre></div></div>
<p></p>
<p>This was a very minimal data documentation effort.  A bit more detail would be better.  Because I would now need to re-write all that in the wizard I will take the advice of the help file that “regular users will find it faster to define the columns and units directly in the format”</p>

<h4 id="code-2">Code:</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ds &lt;- data.set(civst_gend_sector,
               col.defs = c("Marriage status", "sex", "education", "counts"),
               unit.defs = list(c("was once married","still married","never married"),
                   c("women", "men"),
                   c("primary school","secondary school","tertiary school"),
                   c("persons"))
               )
ds
# this prints the dataset and the metadata
# now run the EML function
eml_write(ds, 
          title = "civst_gend_sector",  
          description = "An example, fictional dataset for Decision Tree Models",
          creator = "Ivan Hanigan &lt;ivanhanigan@gmail.com&gt;",
          file = "inst/extdata/civst_gend_sector_eml.xml"
          )
# this created the xml and csv with out asking anything
# but returned a
## Warning message:
## In `[&lt;-.data.frame`(`*tmp*`, , value = list(civil_status = c(2L,  :
##   Setting class(x) to NULL;   result will no longer be an S4 object

# TODO investigate this?

# now we can access the local EML
obj &lt;- eml_read("inst/extdata/civst_gend_sector_eml.xml")
obj 
str(dataTable(obj))
# returns an error
## Error in plyr::compact(lapply(slotNames(from), function(s) if (!isEmpty(slot(from,  (from attribute.R#300) : 
##   subscript out of bounds
</code></pre></div></div>
<p></p>

<h1 id="conclusions">Conclusions</h1>
<p>So this looks like a useful tool.  Next steps are to:</p>

<ul>
  <li>look at sending these data to figshare</li>
  <li>describe a really really REALLY simple workflow (3 lines? create metadata, eml_write, push to figshare)</li>
</ul>

      <div class="clear"></div>
    </div>
    <p class="alt-font tight">
      Posted in&nbsp;
      
      <a href="/categories/Data Documentation" title="Data Documentation" rel="category tag">Data Documentation</a>
      
    </p>
    <!--
	<p class="comments-link">
      <a href='/2013/10/data-documentation-case-study-reml-and-rfigshare/#disqus_thread'>Comments</a>
    </p>
	-->
    <p class="by-line">
      <span class="date full-date">
        <abbr class="published" title="2013-10-12 00:00:00 +0800">12 Oct 2013</abbr>
      </span>
    </p>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>

  <div class="full">
    <h1 class="entry-title">
      <a href="/2013/10/two-main-types-of-data-documentation-workflow/" title="two-main-types-of-data-documentation-workflow" rel="bookmark">two-main-types-of-data-documentation-workflow</a>
    </h1>
    <div class="entry-content full-content">
      <p>This post introduces a new series of blog posts in which I want to experiment with a few tools for data documentation, which I’ll present as Case Studies.  This series of posts will be pitched to an audience mixture of data librarians and data analysts.</p>

<p>Data documentation occurs in a spectrum from simple notes through to elaborate systems.  I’ve been working on a conceptual framework about how the actual process can be done in two distinct ways:</p>

<ul>
  <li>Graphical User Interface (GUI) solutions</li>
  <li>Programmatic (Scripted/Automagic) solutions</li>
</ul>

<p>I think the GUI tools are in general pretty user friendly and useful
for simple projects with only a small number of datasets, but have a
major drawback for the challenge of heterogeneous data integration.  I
think the problem is expressed nicely <a href="http://carlboettiger.info/2013/06/23/notes-on-leveraging-the-ecological-markup-language.html">In This Post By Carl Boettiger</a>  in reference to Morpho:</p>

<ul>
  <li>“looks like a rather useful if tedious tool for generating EML
files. Unfortunately, without the ability to script inputs or
automatically detect existing data structures, we are forced through
the rather arduous process of adding all metadata annotation each
time….”</li>
  <li>“…A package could also provide utilities to generate EML from R objects, leveraging the metadata implicit in R objects that is not present in a CSV (in which there is no built-in notion of whether  a column is numeric or character string, what missing value characters it uses, or really if it is consistent at all. Avoiding manual specification of these things makes the metadata annotation less tedious as well.”</li>
</ul>

<h1 id="centralised-repository-distributed-users">Centralised Repository, Distributed Users</h1>
<p>A key aspect of current approaches is the existence of a centralised data management system.  All the examples I consider include at least a metadata catalogue and some also include a data repository.  An additional feature sometimes exists for managing users permissions.</p>

<p>The relationship between users and centralised services is a really complicated space, but essentially consists of the ability for users to create the documentation and push it (perhaps along with the data) to the metadata catalogue  and/or repository.  So given these assumptions I propose the following types of arrangement:</p>

<ul>
  <li>user sends metadata to metadata catalogue</li>
  <li>user sends metadata and data to metadata catalogue and data repository</li>
  <li>user sends metadata and data and permissions information to metadata catalogue and data repository and permissions system.</li>
</ul>

<p>The Case Studies I’ve identified that I want to explore are listed below, names follow the format ‘client tool’-and-‘data repository or metadata catalogue’-and-optionally-‘permissions system’:</p>

<h4 id="programmatic-solutions">Programmatic solutions</h4>
<ul>
  <li>reml-and-rfigshare</li>
  <li>reml-and-knb (when/if this becomes available)</li>
  <li>make_ddixml-and-ddiindex-and-orapus</li>
  <li>r2ddi-ddiindex</li>
  <li>dc-uploader-and-ANU-DataCommons</li>
  <li>dc-uploader-and-RDA</li>
</ul>

<h4 id="graphical-user-interface-solutions">Graphical User Interface solutions</h4>
<ul>
  <li>morpho-and-knb-metacat</li>
  <li>nesstar-publisher-and-nesstar-and-whatever-Steve-calls-the-ADA-permissions-system</li>
  <li>xmet-and-Australian-Spatial-Data-Directory</li>
  <li>sdmx-editor-and-sdmx-registry</li>
</ul>

      <div class="clear"></div>
    </div>
    <p class="alt-font tight">
      Posted in&nbsp;
      
      <a href="/categories/Data Documentation" title="Data Documentation" rel="category tag">Data Documentation</a>
      
    </p>
    <!--
	<p class="comments-link">
      <a href='/2013/10/two-main-types-of-data-documentation-workflow/#disqus_thread'>Comments</a>
    </p>
	-->
    <p class="by-line">
      <span class="date full-date">
        <abbr class="published" title="2013-10-11 00:00:00 +0800">11 Oct 2013</abbr>
      </span>
    </p>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>

  <div class="full">
    <h1 class="entry-title">
      <a href="/2013/10/wickhams-tidy-tools-only-get-you-90-pct-the-way/" title="wickhams-tidy-tools-only-get-you-90-pct-the-way" rel="bookmark">wickhams-tidy-tools-only-get-you-90-pct-the-way</a>
    </h1>
    <div class="entry-content full-content">
      <h4 id="hadley-wickhams-tidy-tools">Hadley Wickham’s tidy tools</h4>
<p>In this video at 8 mins 50 seconds he says “these four tools do 90% of the job”</p>

<ul>
  <li>subset,</li>
  <li>transform,</li>
  <li>summarise, and</li>
  <li>arrange</li>
  <li>TODO I noticed <a href="http://www.rstudio.com/training/curriculum/data-manipulation.html">at the website for an Rstudio  course</a> transform has been replaced by mutate as one of the “four basic verbs of data manipulation”.</li>
</ul>

<iframe src="//player.vimeo.com/video/33727555" width="500" height="281" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
<p><a href="http://vimeo.com/33727555">Tidy Data</a> from <a href="http://vimeo.com/user2150538">Drew Conway</a> on <a href="https://vimeo.com">Vimeo</a>.</p>

<p>So I thought what’s the other 10?  Here’s a few contenders for my work:</p>

<ul>
  <li>merge</li>
  <li>reshape::cast and reshape::melt</li>
  <li>unlist</li>
  <li>t() transpose</li>
  <li>sprintf or paste</li>
</ul>

<p></p>
<h4 id="r-subset">R-subset</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Filter rows by criteria
subset(airquality, Temp &gt; 90, select = c(Ozone, Temp))

## NB This is a convenience function intended for use interactively.  For
## programming it is better to use the standard subsetting functions like
## ‘[’, and in particular the non-standard evaluation of argument
## ‘subset’ can have unanticipated consequences.

with(airquality,
     airquality[Temp &gt; 90, c("Ozone", "Temp")]
     )

# OR

airquality[airquality$Temp &gt; 90,  c("Ozone", "Temp")] #### R-transform
# New columns that are functions of other columns       
df &lt;- transform(airquality,
                new = -Ozone,
                Temp2 = (Temp-32)/1.8
                )
head(df) #### R-mutate
require(plyr)
# same thing as transform
df &lt;- mutate(airquality, new = -Ozone, Temp = (Temp - 32) / 1.8)    
# Things transform can't do
df &lt;- mutate(airquality, Temp = (Temp - 32) / 1.8, OzT = Ozone / Temp)

# mutate is rather faster than transform
system.time(transform(baseball, avg_ab = ab / g))
system.time(mutate(baseball, avg_ab = ab / g)) #### R-summarise
# New data.frame where columns are functions of existing columns
require(plyr)    
df &lt;- ddply(.data = airquality,
            .variables = "Month",
            .fun = summarise,
            tmax = max(Temp),
            tav = mean(Temp),
            ndays = length(unique(Day))
            )
head(df)
</code></pre></div></div>

<h4 id="passing-variables-to-ddply-for-summary">Passing variables to ddply for summary</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Notice how the name of the variable Temp doesn't need quotes?
# this means that you need to hard code the names
# But if you want to pass variables to this inside a function we need a
# different approach.

summarise_df  &lt;- function(x, by, var1, var2, var3)
  {
    data_out &lt;- ddply(x,
                      by,
                      function(df) return(
                        c(
                          tmax = max(df[,var1]),
                          tav = mean(df[,var2]),
                          ndays = length(unique(df[,var3]))
                          )
                        )
                      )
    return(data_out)
  }

df2 &lt;- summarise_df(x = airquality, by = "Month",
                   var1 = "Temp", var2 = "Temp", var3 = "Day"
                   )

head(df2)
all.equal(df,df2)
# TRUE
</code></pre></div></div>

<h4 id="another-alternative-if-we-want-to-pass-the-dataset-as-string-too">Another alternative, if we want to pass the dataset as string too</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summarise_df2  &lt;- function(x, by, var1, var2, var3)
  {
    data_out &lt;- eval(
      parse(
        text =
        sprintf(
          "ddply(.data = %s,
            .variables = '%s',
            .fun = summarise,
            tmax = max(%s),
            tav = mean(%s),
            ndays = length(unique(%s))
            )", x, by, var1, var2, var3
          )
        )
      )
    return(data_out)
  }

df3 &lt;- summarise_df2(x = "airquality", by = "Month",
                     var1 = "Temp", var2 = "Temp", var3 = "Day"
                     )
head(df3)
all.equal(df, df3)
# TRUE #### R-arrange
# Re-order the rows of a data.frame
df &lt;- arrange(airquality, Temp, Ozone)
head(df)
</code></pre></div></div>

      <div class="clear"></div>
    </div>
    <p class="alt-font tight">
      Posted in&nbsp;
      
      <a href="/categories/research methods" title="research methods" rel="category tag">research methods</a>
      
    </p>
    <!--
	<p class="comments-link">
      <a href='/2013/10/wickhams-tidy-tools-only-get-you-90-pct-the-way/#disqus_thread'>Comments</a>
    </p>
	-->
    <p class="by-line">
      <span class="date full-date">
        <abbr class="published" title="2013-10-10 00:00:00 +0800">10 Oct 2013</abbr>
      </span>
    </p>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>

  <div class="full">
    <h1 class="entry-title">
      <a href="/2013/10/test-data-for-classification-trees/" title="test-data-for-classification-trees" rel="bookmark">test-data-for-classification-trees</a>
    </h1>
    <div class="entry-content full-content">
      <h4 id="a-fictitious-sample-dataset">A fictitious sample dataset</h4>
<p>For discussion, I’ll use a fictional example dataset that I’m using to work through some statistical theory related to Classification and Regression Trees (CART).
In the motivating example use case we are interested in predicting the civil status (married, single, divorced/widowed) of individuals from their sex (male, female) and sector of activity (primary, secondary, tertiary). The data set is composed of 273 cases.</p>

<p>The data (and related statistical theory) come from:</p>

<ul>
  <li>
    <p>Ritschard, G. (2006). Computing and using the deviance with classification trees. In Compstat 2006 - Proceedings in Computational Statistics 17th Symposium Held in Rome, Italy, 2006. Retrieved from <a href="http://mephisto.unige.ch/pub/publications/gr/ritschard_compstat06.pdf">This Link</a></p>
  </li>
  <li>
    <p>Ritschard, G., Pisetta, V., &amp; Zighed, D. (2008). Inducing and evaluating classification trees with statistical implicative criteria. Statistical Implicative Analysis. Studies in Computational Intelligence Volume 127, pp 397-419. Retrieved from <a href="http://mephisto.unige.ch/pub/publications/gr/ritsch-pisetta-zighed_bookGras_rev.pdf">This Link</a></p>
  </li>
</ul>

<h4 id="code">Code:</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># copy and paste the data from the PDF (Table 1 in both papers)
civst_gend_sector  &lt;- read.csv(textConnection(
    "civil_status gender activity_sector number_of_cases
         married   male         primary              50
         married   male       secondary              40
         married   male        tertiary               6
         married female         primary               0
         married female       secondary              14
         married female        tertiary              10
          single   male         primary               5
          single   male       secondary               5
          single   male        tertiary              12
          single female         primary              50
          single female       secondary              30
          single female        tertiary              18
divorced/widowed   male         primary               5
divorced/widowed   male       secondary               8
divorced/widowed   male        tertiary              10
divorced/widowed female         primary               6
divorced/widowed female       secondary               2
divorced/widowed female        tertiary               2
"),sep = "")

# save this to my personal R utilities package "disentangle" 
# for use later when I am exploring functions
dir.create("inst/extdata", recursive=T)
write.csv(civst_gend_sector, "inst/extdata/civst_gend_sector.csv", row.names = F)
</code></pre></div></div>

<p></p>

<p>That is fine and good, we can use the case weights option to include number of cases but sometimes we want to use one row per person.
In the next chunk of code I;ll reformat the data, and also add another fictitious variable called income and contrive an example where a certain group earns less based on their activity sector.</p>

<h4 id="code-1">Code:</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>df &lt;- as.data.frame(matrix(NA, nrow = 0, ncol = 3))
for(i in 1:nrow(civst_gend_sector))
    {
    #    i &lt;- 1
        n &lt;- civst_gend_sector$number_of_cases[i]
        if(n == 0) next
        for(j in 1:n)
            {
              df &lt;- rbind(df, civst_gend_sector[i,1:3])              
            }
 
    }

df$income  &lt;- rnorm(nrow(df), 1000,200)
# Let us say secondary men earn less
df$income[df$gender == "male" &amp; df$activity == "secondary"]  &lt;- df$income[df$gender == "male" &amp; df$activity == "secondary"] - 500
str(df)
# save this for use later
write.csv(df, "inst/extdata/civst_gend_sector_full.csv", row.names = F)
</code></pre></div></div>

<h4 id="motivating-reason-for-using-these-data">Motivating reason for using these data</h4>
<p>Classification and Regression Tree models (also referred to as Decision Trees) are one of the building blocks of data mining and a great tool for Exploratory Data Analysis.</p>

<p>I’ve mostly used Regression Trees in the past but recently got some work with social science data where Classification Trees were needed.  I wanted to assess the deviance as well as the misclassification error rate for measuring the descriptive power of the tree.  While this is a easy with Regression Trees it became obvious that it was not so easy with Classification Trees.  This is because Classification Trees are most often evaluated by means of the error rate. The problem with the error rate is that it is not that helpful for assessing the descriptive capacity of the tree.</p>

<p>For example if we look at the reduction in deviance between the Null model and the fitted tree we can say that the tree explains about XYZ% of the variation. We can also test if this is a statistically significant reduction based on a chi-squared test.</p>

<p>Consider this example from page 310 of Hastie, T., Tibshirani, R., &amp; Friedman, J. (2001). The elements of statistical learning. 2nd Edition:</p>

<ul>
  <li>in a two-class problem with 400 observations in each class (denote this by (400, 400))</li>
  <li>suppose one split created nodes (300, 100) and (100, 300),</li>
  <li>the other created nodes (200, 400) and (200, 0).</li>
  <li>Both splits produce a misclassification rate of 0.25, but the second split produces a pure node and is probably preferable.</li>
</ul>

<p>During the course of my research to try to identify the best available method to implement in my analysis I found a useful series of papers by Ritschard, with a worked example using SPSS.  I hope to translate that to R in the future, but the first thing I did was grab the example data used in several of those papers out of the PDF.  So seeing as this was a public dataset (I use a lot of restricted data) and because I want to be able to use it to demonstrate the use of any R functions I find or write… I thought would publish it properly.</p>

<h4 id="the-tree-model">The Tree Model</h4>
<p>So just before we leave Ritschard and the CART method, let’s just fit the model.  Let’s also install my R utilities package “disentangle”, to test that we can access the data from it.</p>

<p>In this analysis the civil status is the outcome (or response or decision or dependent) variable, while sex and activity sector are the predictors (or condition or independent variables).</p>

<h4 id="code-2">Code:</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># func
require(rpart)
require(partykit) 
require(devtools)
install_github("disentangle", "ivanhanigan")

# load
fpath &lt;- system.file(file.path("extdata", "civst_gend_sector.csv"),
                     package = "disentangle"
                     )
civst_gend_sector &lt;- read.csv(fpath)

# clean
str(civst_gend_sector)

# do
fit &lt;- rpart(civil_status ~ gender + activity_sector,
             data = civst_gend_sector, weights = number_of_cases,
             control=rpart.control(minsplit=1))
# NB need minsplit to be adjusted for weights.
summary(fit)
  
# report
dir.create("images")
png("images/fit1.png", 1000, 480)
plot(as.party(fit))
dev.off()
</code></pre></div></div>

<h4 id="the-result">The Result</h4>
<p><img src="/images/fit1.png" alt="fit1.png" /></p>

      <div class="clear"></div>
    </div>
    <p class="alt-font tight">
      Posted in&nbsp;
      
      <a href="/categories/Data Documentation" title="Data Documentation" rel="category tag">Data Documentation</a>
      
    </p>
    <!--
	<p class="comments-link">
      <a href='/2013/10/test-data-for-classification-trees/#disqus_thread'>Comments</a>
    </p>
	-->
    <p class="by-line">
      <span class="date full-date">
        <abbr class="published" title="2013-10-10 00:00:00 +0800">10 Oct 2013</abbr>
      </span>
    </p>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>

  <div class="full">
    <h1 class="entry-title">
      <a href="/2013/10/simple-example-using-nmmaps/" title="simple-example-using-nmmaps" rel="bookmark">simple-example-using-nmmaps</a>
    </h1>
    <div class="entry-content full-content">
      <p>I will use the NMMAPSlite datasets for a simple example of what I am trying to do.</p>

<!-- begin_src R :session *R* :tangle NMMAPS-example/NMMAPS-example-code.r :exports none :eval no -->

<h4 id="code-get-nmmaps-data">Code: get nmmaps data</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># func
if(!require(NMMAPSlite)) install.packages('NMMAPSlite');require(NMMAPSlite)
require(mgcv)
require(splines)

######################################################
# load  
setwd('data')
initDB('data/NMMAPS') # this requires that we connect to the web,
                      # so lets get local copies
setwd('..')
cities &lt;- getMetaData('cities')
head(cities)
citieslist &lt;- cities$cityname
# write out a few cities for access later
for(city_i in citieslist[sample(1:nrow(cities), 9)])
{
 city &lt;- subset(cities, cityname == city_i)$city
 data &lt;- readCity(city)
 write.table(data, file.path('data', paste(city_i, '.csv',sep='')),
 row.names = F, sep = ',')
}
# these are all tiny, go some big ones
for(city_i in c('New York', 'Los Angeles', 'Madison', 'Boston'))
{
 city &lt;- subset(cities, cityname == city_i)$city
 data &lt;- readCity(city)
 write.table(data, file.path('data', paste(city_i, '.csv',sep='')),
 row.names = F, sep = ',')
}

######################################################
# now we can use these locally
dir("data")
city &lt;- "Chicago"
data &lt;- read.csv(sprintf("data/%s.csv", city), header=T)
str(data)
data$yy &lt;- substr(data$date,1,4)
data$date &lt;- as.Date(data$date)
######################################################
# check
par(mfrow=c(2,1), mar=c(4,4,3,1))
with(subset(data[,c(1,15:25)], agecat == '75p'),
  plot(date, tmax)
 )
with(subset(data[,c(1,4,15:25)], agecat == '75p'),
        plot(date, cvd, type ='l', col = 'grey')
        )
with(subset(data[,c(1,4,15:25)], agecat == '75p'),
        lines(lowess(date, cvd, f = 0.015))
        )
# I am worried about that outlier
data$date[which(data$cvd &gt; 100)]
# [1] "1995-07-15" "1995-07-16"
 
######################################################
# do standard NMMAPS timeseries poisson GAM model
numYears&lt;-length(names(table(data$yy)))
df &lt;- subset(data, agecat == '75p')
df$time &lt;- as.numeric(df$date)
fit &lt;- gam(cvd ~ s(pm10tmean) + s(tmax) + s(dptp) + s(time, k= 7*numYears, fx=T), data = df, family = poisson)
# plot of response functions
par(mfrow=c(2,2))
plot(fit)
dev.off()
 
######################################################
# some diagnostics
summary(fit)
# note the R-sq.(adj) =   0.21
gam.check(fit)
# note the lack of a leverage plot.  for that we need glm
 
######################################################
# do same model as glm
fit2 &lt;- glm(cvd ~ pm10tmean + ns(tmax, df = 8) + ns(dptp, df = 4) + ns(time, df = 7*numYears), data = df, family = poisson)
# plot responses
par(mfrow=c(2,2))
termplot(fit2, se =T)
dev.off()
 
# plot prediction
df$predictedCvd &lt;- predict(fit2, df, 'response')
# baseline is given by the intercept
fit3 &lt;- glm(cvd ~ 1, data = df, family = poisson)
df$baseline &lt;-  predict(fit3, df, 'response')
with(subset(df, date&gt;=as.Date('1995-01-01') &amp; date &lt;= as.Date('1995-07-31')),
 plot(date, cvd, type ='l', col = 'grey')
        )
with(subset(df, date&gt;=as.Date('1995-01-01') &amp; date &lt;= as.Date('1995-07-31')),
        lines(date,predictedCvd)
        )
with(subset(df, date&gt;=as.Date('1995-01-01') &amp; date &lt;= as.Date('1995-07-31')),
 lines(date,baseline)
        )
######################################################
# some diagnostics
# need to load a function to calculate poisson adjusted R squared
# original S code from
# The formula for pseudo-R^2 is taken from G. S. Maddalla,
# Limited-dependent and Qualitative Variables in Econometrics, Cambridge:Cambridge Univ. Press, 1983. page 40, equation 2.50.
RsquaredGlm &lt;- function(o) {
 n &lt;- length(o$residuals)
 ll &lt;- logLik(o)[1]
 ll_0 &lt;- logLik(update(o,~1))[1]
 R2 &lt;- (1 - exp(((-2*ll) - (-2*ll_0))/n))/(1 - exp( - (-2*ll_0)/n))
 names(R2) &lt;- 'pseudo.Rsquared'
 R2
 }
RsquaredGlm(fit2)
# 0.51
# the difference is presumably due to the arguments about how to account for unexplainable variance in the poisson distribution?
 
# significance of spline terms
drop1(fit2, test='Chisq')
# also note AIC. best model includes all of these terms
# BIC can be computed instead (but still labelled AIC) using
drop1(fit2, test='Chisq', k = log(nrow(data)))
 
# diagnostic plots
par(mfrow=c(2,2))
plot(fit2)
dev.off()
# note high leverage plus residuals points are labelled
# leverage doesn't seem to be too high though which is good
# NB the numbers refer to the row.names attribute which still refer to the original dataset, not this subset
df[row.names(df) %in% c(9354,9356),]$date
# as suspected [1] "1995-07-15" "1995-07-16"
 
######################################################
# so lets re run without these obs
df2 &lt;- df[!row.names(df) %in% c(9354,9356),]
# to avoid duplicating code just re run fit2, replacing data=df with df2
# tmax still significant but not so extreme
# check diagnostic plots again
par(mfrow=c(2,2))
plot(fit2)
dev.off()
# looks like a well behaved model now.
 
# if we were still worried about any high leverage values we could identify these with
df3 &lt;- na.omit(df2[,c('cvd','pm10tmean','tmax','dptp','time')])
df3$hatvalue &lt;- hatvalues(fit2)
df3$res &lt;- residuals(fit2, 'pearson')
with(df3, plot(hatvalue, res))
# this is the same as the fourth default glm diagnostic plot, which they label x-axis as leverage
summary(df3$hatvalue)
# gives us an idea of the distribution of hat values
# decide on a threshold and look at it
hatThreshold &lt;- 0.1
with(subset(df3, hatvalue &gt; hatThreshold), points(hatvalue, res, col = 'red', pch = 16))
abline(0,0)
segments(hatThreshold,-2,hatThreshold,15)
dev.off()
 
fit3 &lt;- glm(cvd ~ pm10tmean + ns(tmax, df = 8) + ns(dptp, df = 4) + ns(time, df = 7*numYears), data = subset(df3, hatvalue &lt; hatThreshold), family = poisson)
par(mfrow=c(2,2))
termplot(fit3, se = T)
# same same
plot(fit3)
# no better
 
# or we could go nuts with a whole number of ways of estimating influence
# check all influential observations
infl &lt;- influence.measures(fit2)
# which observations 'are' influential
inflk &lt;- which(apply(infl$is.inf, 1, any))
length(inflk)
 
 
######################################################
# now what about serial autocorrelation in the residuals?
 
par(mfrow = c(2,1))
with(df3, acf(res))
with(df3, pacf(res))
dev.off()
 
 
 
######################################################
# just check for overdispersion
fit &lt;- gam(cvd ~ s(pm10tmean) + s(tmax) + s(dptp) + s(time, k= 7*numYears, fx=T), data = df, family = quasipoisson)
summary(fit)
# note the Scale est. = 1.1627
# alternatively check the glm
fit2 &lt;- glm(cvd ~ pm10tmean + ns(tmax, df = 8) + ns(dptp, df = 4) + ns(time, df = 7*numYears), data = df, family = quasipoisson)
summary(fit2)
# (Dispersion parameter for quasipoisson family taken to be 1.222640)
# this is probably near enough to support a standard poisson model...
 
# if we have overdispersion we can use QAIC (A quasi- mode does not have a likelihood and so does not have an AIC,  by definition)
# we can use the poisson model and calculate the overdispersion
fit2 &lt;- glm(cvd ~ pm10tmean + ns(tmax, df = 8) + ns(dptp, df = 4) + ns(time, df = 7*numYears), data = df, family = poisson)
1- pchisq(deviance(fit2), df.residual(fit2))
 
# QAIC, c is the variance inflation factor, the ratio of the residual deviance of the global (most complicated) model to the residual degrees of freedom
c=deviance(fit2)/df.residual(fit2)
QAIC.1=-2*logLik(fit2)/c + 2*(length(coef(fit2)) + 1)
QAIC.1
 
# Actually lets use QAICc which is more conservative about parameters,
QAICc.1=-2*logLik(fit2)/c + 2*(length(coef(fit2)) + 1) + 2*(length(coef(fit2)) + 1)*(length(coef(fit2)) + 1 + 1)/(nrow(na.omit(df[,c('cvd','pm10tmean','tmax','dptp','time')]))- (length(coef(fit2))+1)-1)
QAICc.1
 
 
######################################################
# the following is old work, some may be interesting
# such as the use of sinusoidal wave instead of smooth function of time
 
 
# # sine wave
# timevar &lt;- as.data.frame(names(table(df$date)))
# index &lt;- 1:length(names(table(df$date)))
# timevar$time2 &lt;- index / (length(index) / (length(index)/365.25))
# names(timevar) &lt;- c('date','timevar')
# timevar$date &lt;- as.Date(timevar$date)
# df &lt;- merge(df,timevar)
 
# fit &lt;- gam(cvd ~ s(tmax) + s(dptp) + sin(timevar * 2 * pi) + cos(timevar * 2 * pi) + ns(time, df = numYears), data = df, family = poisson)
# summary(fit)
# par(mfrow=c(3,2))
# plot(fit, all.terms = T)
# dev.off()
 
# # now just explore the season fit
# fit &lt;- gam(cvd ~ sin(timevar * 2 * pi) + cos(timevar * 2 * pi) + ns(time, df = numYears), data = df, family = poisson)
# yhat &lt;- predict(fit)
# head(yhat)
 
# with(df, plot(date,cvd,type = 'l',col='grey', ylim = c(15,55)))
# lines(df[,'date'],exp(yhat),col='red')
 
 
# # drop1(fit, test= 'Chisq')
 
# # drop1 only works in glm?
# # fit with weather variables, use degrees of freedom estimated by gam
# fit &lt;- glm(cvd ~ ns(tmax,8) + ns(dptp,2) + sin(timevar * 2 * pi) + cos(timevar * 2 * pi) + ns(time, df = numYears), data = df, family = poisson)
# drop1(fit, test= 'Chisq')
# # use plot.glm for diagnostics
# par(mfrow=c(2,2))
# plot(fit)
# par(mfrow=c(3,2))
# termplot(fit, se=T)
# dev.off()
 
# # cyclic spline, overlay on prior sinusoidal
# with(df, plot(date,cvd,type = 'l',col='grey', ylim = c(0,55)))
# lines(df[,'date'],exp(yhat),col='red')
 
# df$daynum &lt;- as.numeric(format(df$date, "%j"))
# df[360:370,c('date','daynum')]
# fit &lt;- gam(cvd ~ s(daynum, k=3, fx=T, bs = 'cp') +  s(time, k = numYears, fx = T), data = df, family = poisson)
# yhat2 &lt;- predict(fit)
# head(yhat2)
 
# lines(df[,'date'],exp(yhat2),col='blue')
 
 
# par(mfrow=c(1,2))
# plot(fit)
 
 
# # fit weather with season
# fit &lt;- gam(cvd ~ s(tmax) + s(dptp) +
  # s(daynum, k=3, fx=T, bs = 'cp') +  s(time, k = numYears, fx = T), data = df, family = poisson)
# par(mfrow=c(2,2))
# plot(fit)
 
# summary(fit)
</code></pre></div></div>

      <div class="clear"></div>
    </div>
    <p class="alt-font tight">
      Posted in&nbsp;
      
      <a href="/categories/spatial dependence" title="spatial dependence" rel="category tag">spatial dependence</a>
      
    </p>
    <!--
	<p class="comments-link">
      <a href='/2013/10/simple-example-using-nmmaps/#disqus_thread'>Comments</a>
    </p>
	-->
    <p class="by-line">
      <span class="date full-date">
        <abbr class="published" title="2013-10-10 00:00:00 +0800">10 Oct 2013</abbr>
      </span>
    </p>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>


<div class="pagination">
  <span class="previous">
    
      
      <a href="/page31/" title="Previous Page">&laquo; Previous</a>
      
    
  </span>
  <span class="next">
    
    <a href="/page33/" title="Next Page">Next &raquo;</a>
    
  </span>
</div>
<!-- <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=SChamberlain"></script> -->

        </div>
        <div id="sidebar">
          <div id="carrington-subscribe" class="widget">
            <h2 class="widget-title">Subscribe</h2>
            <a class="feed alignright" title="RSS 2.0 feed for posts" rel="alternate" href="http://feeds.feedburner.com/Disentanglethings">
              <img src="/images/rss-button.gif" alt="latest posts" title="latest posts">
            </a>
          </div>
          <div id="carrington-about" class="widget">
            <div class="about">
              <h2 class="widget-title">About</h2>
              <p>I am an Environmental Epidemiologist and Senior Lecturer in Climate Change and Health at Curtin University in Western Australia.</p>
              <a class="more" href="/about">more →</a>

            </div>
          </div>
<div class="sidebar">
  <div class="logos">
  
  <ul>
          
      <!-- Add in logos here -->
      <a href="http://scholar.google.com/citations?user=cGN1P0wAAAAJ&hl=en"><img src="/images/GSIcon.jpg" height=22px width=22px/></a>&nbsp;&nbsp;&nbsp;&nbsp; 
          
      <!-- Add in logos here -->
      <a href="http://orcid.org/0000-0002-6360-6793"><img src="/images/ORCID.png" height=22px width=22px/></a>&nbsp;&nbsp;&nbsp;&nbsp; 
          
      <!-- Add in logos here -->
      <a href="http://github.com/ivanhanigan"><img src="/images/github.png" height=22px width=22px/></a>&nbsp;&nbsp;&nbsp;&nbsp; 
          
      <!-- Add in logos here -->
      <a href="mailto:ivan.hanigan@gmail.com"><img src="/images/gmail.png" height=22px width=22px/></a>&nbsp;&nbsp;&nbsp;&nbsp; 
          
      <!-- Add in logos here -->
      <a href="https://twitter.com/ivanhanigan"><img src="/images/twitter.png" height=22px width=22px/></a>&nbsp;&nbsp;&nbsp;&nbsp; 
    
  </ul>
   
  </div>
</div>
          <!--
          	<p>
              <a href="http://ropensci.org/">
                <img src="/images/ropensci.png">
              </a>
        	</p>
			-->
			<!--
          <div id="carrington-link" class="widget">
          	<a href="http://ropensci.org/">
            <img src="/images/ropensci.png">
          </div>
          	-->
          
          <div id="primary-sidebar">
            <div class="widget">
              <h2 class="widget-title">Recent Entries</h2>
              <ul>
                
                <li>
                  <a href="/2022/12/bushfire-smoke-mortality-in-sydney-nsw/" title="Bushfire Smoke and Mortality in Sydney NSW" rel="bookmark">Bushfire Smoke and Mortality in Sydney NSW</a>
                </li>
                
                <li>
                  <a href="/2022/10/MJA-Lancet-Countdown-report-2022/" title="MJA-Lancet Countdown report 2022" rel="bookmark">MJA-Lancet Countdown report 2022</a>
                </li>
                
                <li>
                  <a href="/2019/07/environmental-health-indicators/" title="Environmental health indicators" rel="bookmark">Environmental health indicators</a>
                </li>
                
                <li>
                  <a href="/2019/07/tscourse-chicago-heatwave/" title="Time series regression in R course codes for Chicago Heatwave" rel="bookmark">Time series regression in R course codes for Chicago Heatwave</a>
                </li>
                
                <li>
                  <a href="/2018/11/climate-change-policy-inaction-threatens-lives/" title="Climate Change policy inaction threatens lives" rel="bookmark">Climate Change policy inaction threatens lives</a>
                </li>
                
              </ul>
              <h2 class="widget-title">Categories</h2>
              <ul>
<!-- <li> -->
<!--               <a class="workflow" href="/categories/workflow.html">workflow</a> -->
<!-- </li> -->
                
                <li><a href="/categories/overview">overview (7)</a></li>
                
                <li><a href="/categories/research methods">research methods (43)</a></li>
                
                <li><a href="/categories/disentangle things">disentangle things (4)</a></li>
                
                <li><a href="/categories/spatial">spatial (9)</a></li>
                
                <li><a href="/categories/extreme weather events">extreme weather events (8)</a></li>
                
                <li><a href="/categories/spatial dependence">spatial dependence (10)</a></li>
                
                <li><a href="/categories/Data Documentation">Data Documentation (31)</a></li>
                
                <li><a href="/categories/awap grids">awap grids (3)</a></li>
                
                <li><a href="/categories/climatic and agricultural drought">climatic and agricultural drought (3)</a></li>
                
                <li><a href="/categories/cloud building">cloud building (3)</a></li>
                
                <li><a href="/categories/disentangle">disentangle (50)</a></li>
                
                <li><a href="/categories/Project Management">Project Management (2)</a></li>
                
                <li><a href="/categories/e-collaboration">e-collaboration (1)</a></li>
                
                <li><a href="/categories/ecosocial tipping points">ecosocial tipping points (2)</a></li>
                
                <li><a href="/categories/Drought">Drought (1)</a></li>
                
                <li><a href="/categories/project management">project management (1)</a></li>
                
                <li><a href="/categories/morpho">morpho (1)</a></li>
                
                <li><a href="/categories/data documentation">data documentation (1)</a></li>
                
                <li><a href="/categories/reproducible research reports">reproducible research reports (2)</a></li>
                
                <li><a href="/categories/Data Management">Data Management (2)</a></li>
                
                <li><a href="/categories/Reproducible Research Reports">Reproducible Research Reports (2)</a></li>
                
                <li><a href="/categories/Data Operation">Data Operation (2)</a></li>
                
                <li><a href="/categories/Workflow tools">Workflow tools (3)</a></li>
                
                <li><a href="/categories/Exploratory Data Analysis">Exploratory Data Analysis (2)</a></li>
                
                <li><a href="/categories/statistical modelling">statistical modelling (2)</a></li>
                
                <li><a href="/categories/blog home">blog home (1)</a></li>
                
                <li><a href="/categories/reproducible research pipelines">reproducible research pipelines (2)</a></li>
                
                <li><a href="/categories/reproducible research">reproducible research (2)</a></li>
                
                <li><a href="/categories/writing">writing (1)</a></li>
                
                <li><a href="/categories/climate data">climate data (1)</a></li>
                
                <li><a href="/categories/exploratory data analysis">exploratory data analysis (2)</a></li>
                
                <li><a href="/categories/bibliometrics and literature reviewing">bibliometrics and literature reviewing (1)</a></li>
                
                <li><a href="/categories/drought awap grids">drought awap grids (1)</a></li>
                
                <li><a href="/categories/drought">drought (2)</a></li>
                
                <li><a href="/categories/data operation">data operation (2)</a></li>
                
                <li><a href="/categories/training">training (2)</a></li>
                
                <li><a href="/categories/swish">swish (3)</a></li>
                
                <li><a href="/categories/air pollution">air pollution (2)</a></li>
                
                <li><a href="/categories/policy relevant research">policy relevant research (3)</a></li>
                
                <li><a href="/categories/climate change">climate change (2)</a></li>
                
                <li><a href="/categories/bushfire smoke">bushfire smoke (1)</a></li>
                
              </ul>
              <h2 class="widget-title">Entries grouped by Tags</h2>
              <ul>
                
                <li><a href="/tag/morpho">morpho (15)</a></li>
                
                <li><a href="/tag/project management">project management (3)</a></li>
                
                <li><a href="/tag/Data Management System">Data Management System (3)</a></li>
                
                <li><a href="/tag/R-eml">R-eml (3)</a></li>
                
                <li><a href="/tag/bugs">bugs (1)</a></li>
                
                <li><a href="/tag/software">software (3)</a></li>
                
                <li><a href="/tag/writing">writing (2)</a></li>
                
                <li><a href="/tag/spatial">spatial (1)</a></li>
                
                <li><a href="/tag/diagrams">diagrams (3)</a></li>
                
                <li><a href="/tag/blogging">blogging (2)</a></li>
                
                <li><a href="/tag/metadata">metadata (1)</a></li>
                
                <li><a href="/tag/R">R (1)</a></li>
                
                <li><a href="/tag/Reproducible Research Reports">Reproducible Research Reports (2)</a></li>
                
                <li><a href="/tag/Data Management">Data Management (3)</a></li>
                
                <li><a href="/tag/Exploratory Data Analysis">Exploratory Data Analysis (1)</a></li>
                
                <li><a href="/tag/bibliometrics and literature reviewing">bibliometrics and literature reviewing (2)</a></li>
                
                <li><a href="/tag/workflow tools">workflow tools (1)</a></li>
                
                <li><a href="/tag/data management">data management (1)</a></li>
                
                <li><a href="/tag/exploratory data analysis">exploratory data analysis (1)</a></li>
                
              <div class="clear"></div>
              </ul>
            </div>
          </div>
          <!-- <div id="secondary-sidebar"> -->
          <!--   <div class="widget"> -->
          <!--     <h2 class="widget-title">Tags</h2> -->
          <!--     <ul> -->
          <!--        -->
          <!--       <li><a href="/tag/morpho">morpho (15)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/project management">project management (3)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/Data Management System">Data Management System (3)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/R-eml">R-eml (3)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/bugs">bugs (1)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/software">software (3)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/writing">writing (2)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/spatial">spatial (1)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/diagrams">diagrams (3)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/blogging">blogging (2)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/metadata">metadata (1)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/R">R (1)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/Reproducible Research Reports">Reproducible Research Reports (2)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/Data Management">Data Management (3)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/Exploratory Data Analysis">Exploratory Data Analysis (1)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/bibliometrics and literature reviewing">bibliometrics and literature reviewing (2)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/workflow tools">workflow tools (1)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/data management">data management (1)</a></li> -->
          <!--        -->
          <!--       <li><a href="/tag/exploratory data analysis">exploratory data analysis (1)</a></li> -->
          <!--        -->
          <!--     <div class="clear"></div> -->
          <!--     </ul> -->
          <!--   </div> -->
            <!--
            <div class="widget">
              <h2 class="widget-title">Archives</h2>
              <ul>
                
              </ul>
              <div class="clear"></div>
            </div>
            -->
          </div>
        </div>
      </div>
    </div>
    <div id="footer" class="section">
      <div class="wrapper">
        <a id="generator-link">
          Banner Artwork by Cindy Hales. Site powered by
          <a href="https://github.com/mojombo/jekyll" rel="generator">Jekyll</a>
          with
          <a href="http://carringtontheme.com" title="Carrington theme for WordPress">Carrington</a>
          theme.
      </div>
      <div id="developer-link">
      </div>
    </div>
    <!--
	<a href="http://github.com/SChamberlain"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://assets2.github.com/img/e6bef7a091f5f3138b8cd40bc3e114258dd68ddf?repo=&url=http%3A%2F%2Fs3.amazonaws.com%2Fgithub%2Fribbons%2Fforkme_right_red_aa0000.png&path=" alt="Fork me on GitHub"></a>
	-->
    <script type="text/javascript">
      var disqus_shortname = 'disentanglethings';

      (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
    </script>
    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-28059658-1");
        pageTracker._trackPageview();
      } catch(err) {}
    </script>
  </body>
</html>
